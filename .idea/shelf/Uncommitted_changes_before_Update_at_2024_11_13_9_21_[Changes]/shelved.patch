Index: frontend/src/router/index.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>/*\r\n * @Author: daidai\r\n * @Date: 2022-01-12 14:22:29\r\n * @LastEditors: Please set LastEditors\r\n * @LastEditTime: 2022-04-28 14:53:02\r\n * @FilePath: \\web-pc\\src\\pages\\big-screen\\router\\index.js\r\n */\r\nimport Vue from \"vue\";\r\nimport VueRouter from \"vue-router\";\r\n\r\nVue.use(VueRouter);\r\n\r\nconst routes = [\r\n    {\r\n        path: '/',\r\n        redirect: '/homeIndex',\r\n    },\r\n    {\r\n        path: '/homeIndex',\r\n        name: 'HomeIndex',\r\n        component: () => import( '../views/HomeIndex.vue'),\r\n    },\r\n    {\r\n        path: '/home',\r\n        name: 'home',\r\n        component: () => import(/* webpackChunkName: \"LSD.bighome\" */ '../views/home.vue'),\r\n        children: [\r\n            {\r\n                path: '/index',\r\n                name: 'index',\r\n                component: () => import(/* webpackChunkName: \"LSD.bighome\" */ '../views/indexs/index.vue'),\r\n            },\r\n            {\r\n                path: '/city/:cityName',\r\n                name: 'city',\r\n                component: () => import('../views/city/index.vue')\r\n            },\r\n            {\r\n                path: '/people/:peopleName',\r\n                name: 'people',\r\n                component: () => import('../views/people/index.vue')\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        path: '/model',\r\n        name: 'model',\r\n        component: () => import('../views/model/index.vue'),\r\n        children: [\r\n            {\r\n                path: '/data',\r\n                name: 'data',\r\n                component: () => import('../views/model/model-1/data.vue')\r\n            },\r\n            {\r\n                path: '/disease',\r\n                name: 'disease',\r\n                component: () => import('../views/model/model-2/data.vue')\r\n            }\r\n        ]\r\n    }\r\n\r\n];\r\nconst router = new VueRouter({\r\n    mode: \"hash\",\r\n    // base: process.env.BASE_URL,\r\n    routes\r\n});\r\n\r\nexport default router;\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/frontend/src/router/index.js b/frontend/src/router/index.js
--- a/frontend/src/router/index.js	(revision fd8204e0a6ebf25a34c136ea9906ae35f40e30b1)
+++ b/frontend/src/router/index.js	(date 1731316220645)
@@ -58,6 +58,11 @@
                 component: () => import('../views/model/model-2/data.vue')
             }
         ]
+    },
+    {
+        path: '/environment',
+        name: 'environment',
+        component: () => import('../views/environment/Index.vue'),
     }
 
 ];
Index: frontend/src/views/indexs/right-top.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!--\r\n * @Author: daidai\r\n * @Date: 2022-03-01 14:13:04\r\n * @LastEditors: Please set LastEditors\r\n * @LastEditTime: 2022-09-27 15:04:49\r\n * @FilePath: \\web-pc\\src\\pages\\big-screen\\view\\indexs\\right-top.vue\r\n-->\r\n<template>\r\n  <Echart\r\n    id=\"rightTop\"\r\n    :options=\"option\"\r\n    class=\"right_top_inner\"\r\n    v-if=\"pageflag\"\r\n    ref=\"charts\"\r\n  />\r\n  <Reacquire v-else @onclick=\"getData\" style=\"line-height: 200px\">\r\n    重新获取\r\n  </Reacquire>\r\n</template>\r\n\r\n<script>\r\nimport { currentGET } from \"api/modules\";\r\nimport {graphic} from \"echarts\"\r\nimport {mylog} from \"@/utils\";\r\nexport default {\r\n  props: {\r\n    province: {\r\n      type: String,\r\n      default: '',\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      option: {},\r\n      pageflag: false,\r\n      timer: null,\r\n      dataItem: {\r\n        title: ['2021-11', '2021-12', '2022-01', '2022-02', '2022-03','2022-04'],\r\n        oneLevel: [270, 49, 670, 123, 684, 747],\r\n        twoLevel: [488, 6, 771, 465, 315, 14],\r\n        threeLevel: [120, 423, 123, 676, 342, 543]\r\n      }\r\n    };\r\n  },\r\n  created() {\r\n\r\n  },\r\n\r\n  mounted() {\r\n     this.getData();\r\n  },\r\n  beforeDestroy() {\r\n    this.clearData();\r\n  },\r\n  watch: {\r\n    province(newVal, oldVal) {\r\n      if (newVal.indexOf(\"省\") >= 0) {\r\n\r\n        this.province = newVal;\r\n        this.dataItem = {\r\n          title: ['2021-11', '2021-12', '2022-01', '2022-02', '2022-03','2022-04'],\r\n          oneLevel: [230, 149, 312, 231, 321, 111],\r\n          twoLevel: [981, 943, 315, 411, 125, 321],\r\n          threeLevel: [231, 413, 323, 376, 442, 43]\r\n        }\r\n        this.getData();\r\n      }else {\r\n        this.dataItem = {\r\n          title: ['2021-11', '2021-12', '2022-01', '2022-02', '2022-03','2022-04'],\r\n              oneLevel: [270, 49, 670, 123, 684, 747],\r\n              twoLevel: [488, 6, 771, 465, 315, 14],\r\n              threeLevel: [120, 423, 123, 676, 342, 543]\r\n        }\r\n        this.getData();\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    clearData() {\r\n      if (this.timer) {\r\n        clearInterval(this.timer);\r\n        this.timer = null;\r\n      }\r\n    },\r\n    getData() {\r\n      this.pageflag = true;\r\n      // this.pageflag =false\r\n      currentGET(\"big4\").then((res) => {\r\n        if (!this.timer) {\r\n        }\r\n        if (res.success) {\r\n          const data = res.data;\r\n          mylog(data);\r\n          data[\"numList3\"] = [120, 423, 123, 676, 342, 543];\r\n          this.countUserNumData = res.data;\r\n          this.$nextTick(() => {\r\n            this.init()\r\n              // this.switper();\r\n          });\r\n        } else {\r\n          this.pageflag = false;\r\n          this.$Message({\r\n            text: res.msg,\r\n            type: \"warning\",\r\n          });\r\n        }\r\n      });\r\n    },\r\n    //轮询\r\n    switper() {\r\n      if (this.timer) {\r\n        return;\r\n      }\r\n      let looper = (a) => {\r\n        this.getData();\r\n      };\r\n      this.timer = setInterval(\r\n        looper,\r\n        this.$store.state.setting.echartsAutoTime\r\n      );\r\n      let myChart = this.$refs.charts.chart;\r\n      myChart.on(\"mouseover\", (params) => {\r\n        this.clearData();\r\n      });\r\n      myChart.on(\"mouseout\", (params) => {\r\n        this.timer = setInterval(\r\n          looper,\r\n          this.$store.state.setting.echartsAutoTime\r\n        );\r\n      });\r\n    },\r\n    init() {\r\n      this.option = {\r\n        xAxis: {\r\n          type: \"category\",\r\n          data: this.dataItem.title,\r\n          boundaryGap: false, // 不留白，从原点开始\r\n          splitLine: {\r\n            show: true,\r\n            lineStyle: {\r\n              color: \"rgba(31,99,163,.2)\",\r\n            },\r\n          },\r\n          axisLine: {\r\n            // show:false,\r\n            lineStyle: {\r\n              color: \"rgba(31,99,163,.1)\",\r\n            },\r\n          },\r\n          axisLabel: {\r\n            color: \"#7EB7FD\",\r\n            fontWeight: \"500\",\r\n          },\r\n        },\r\n        yAxis: {\r\n          type: \"value\",\r\n          splitLine: {\r\n            show: true,\r\n            lineStyle: {\r\n              color: \"rgba(31,99,163,.2)\",\r\n            },\r\n          },\r\n          axisLine: {\r\n            lineStyle: {\r\n              color: \"rgba(31,99,163,.1)\",\r\n            },\r\n          },\r\n          axisLabel: {\r\n            color: \"#7EB7FD\",\r\n            fontWeight: \"500\",\r\n          },\r\n        },\r\n        tooltip: {\r\n          trigger: \"axis\",\r\n          backgroundColor: \"rgba(0,0,0,.6)\",\r\n          borderColor: \"rgba(147, 235, 248, .8)\",\r\n          textStyle: {\r\n            color: \"#FFF\",\r\n          },\r\n        },\r\n        grid: {\r\n          //布局\r\n          show: true,\r\n          left: \"10px\",\r\n          right: \"30px\",\r\n          bottom: \"10px\",\r\n          top: \"28px\",\r\n          containLabel: true,\r\n          borderColor: \"#1F63A3\",\r\n        },\r\n        series: [\r\n          {\r\n            data: this.dataItem.oneLevel,\r\n            type: \"line\",\r\n            smooth: true,\r\n            symbol: \"none\", //去除点\r\n            name: \"一级预警数\",\r\n            color: \"rgba(252,144,16,.7)\",\r\n            areaStyle: {\r\n                //右，下，左，上\r\n                color: new graphic.LinearGradient(\r\n                  0,\r\n                  0,\r\n                  0,\r\n                  1,\r\n                  [\r\n                    {\r\n                      offset: 0,\r\n                      color: \"rgba(252,144,16,.7)\",\r\n                    },\r\n                    {\r\n                      offset: 1,\r\n                      color: \"rgba(252,144,16,.0)\",\r\n                    },\r\n                  ],\r\n                  false\r\n                ),\r\n            },\r\n            markPoint: {\r\n              data: [\r\n                {\r\n                  name: \"最大值\",\r\n                  type: \"max\",\r\n                  valueDim: \"y\",\r\n                  symbol: \"rect\",\r\n                  symbolSize: [60, 26],\r\n                  symbolOffset: [0, -20],\r\n                  itemStyle: {\r\n                    color: \"rgba(0,0,0,0)\",\r\n                  },\r\n                  label: {\r\n                    color: \"#FC9010\",\r\n                    backgroundColor: \"rgba(252,144,16,0.1)\",\r\n                    borderRadius: 6,\r\n                    padding: [7, 14],\r\n                    borderWidth: 0.5,\r\n                    borderColor: \"rgba(252,144,16,.5)\",\r\n                    formatter: \"一级预警：{c}\",\r\n                  },\r\n                },\r\n                {\r\n                  name: \"最大值\",\r\n                  type: \"max\",\r\n                  valueDim: \"y\",\r\n                  symbol: \"circle\",\r\n                  symbolSize: 6,\r\n                  itemStyle: {\r\n                    color: \"#FC9010\",\r\n                    shadowColor: \"#FC9010\",\r\n                    shadowBlur: 8,\r\n                  },\r\n                  label: {\r\n                    formatter: \"\",\r\n                  },\r\n                },\r\n              ],\r\n            },\r\n          },\r\n          {\r\n            data: this.dataItem.twoLevel,\r\n            type: \"line\",\r\n            smooth: true,\r\n            symbol: \"none\", //去除点\r\n            name: \"二级预警次数\",\r\n            color: \"rgba(9,202,243,.7)\",\r\n            areaStyle: {\r\n                //右，下，左，上\r\n                color: new graphic.LinearGradient(\r\n                  0,\r\n                  0,\r\n                  0,\r\n                  1,\r\n                  [\r\n                    {\r\n                      offset: 0,\r\n                      color: \"rgba(9,202,243,.7)\",\r\n                    },\r\n                    {\r\n                      offset: 1,\r\n                      color: \"rgba(9,202,243,.0)\",\r\n                    },\r\n                  ],\r\n                  false\r\n                ),\r\n            },\r\n            markPoint: {\r\n              data: [\r\n                {\r\n                  name: \"最大值\",\r\n                  type: \"max\",\r\n                  valueDim: \"y\",\r\n                  symbol: \"rect\",\r\n                  symbolSize: [60, 26],\r\n                  symbolOffset: [0, -20],\r\n                  itemStyle: {\r\n                    color: \"rgba(0,0,0,0)\",\r\n                  },\r\n                  label: {\r\n                    color: \"#09CAF3\",\r\n                    backgroundColor: \"rgba(9,202,243,0.1)\",\r\n\r\n                    borderRadius: 6,\r\n                    borderColor: \"rgba(9,202,243,.5)\",\r\n                    padding: [7, 14],\r\n                    formatter: \"二级预警：{c}\",\r\n                    borderWidth: 0.5,\r\n                  },\r\n                },\r\n                {\r\n                  name: \"最大值\",\r\n                  type: \"max\",\r\n                  valueDim: \"y\",\r\n                  symbol: \"circle\",\r\n                  symbolSize: 6,\r\n                  itemStyle: {\r\n                    color: \"#09CAF3\",\r\n                    shadowColor: \"#09CAF3\",\r\n                    shadowBlur: 8,\r\n                  },\r\n                  label: {\r\n                    formatter: \"\",\r\n                  },\r\n                },\r\n              ],\r\n            },\r\n          },\r\n          {\r\n            data: this.dataItem.threeLevel,\r\n            type: \"line\",\r\n            smooth: true,\r\n            symbol: \"none\", //去除点\r\n            name: \"三级级预警次数\",\r\n            color: \"rgba(212,0,0,0.7)\",\r\n            areaStyle: {\r\n              //右，下，左，上\r\n              color: new graphic.LinearGradient(\r\n                  0,\r\n                  0,\r\n                  0,\r\n                  1,\r\n                  [\r\n                    {\r\n                      offset: 0,\r\n                      color: \"rgba(231,22,22,0.7)\",\r\n                    },\r\n                    {\r\n                      offset: 1,\r\n                      color: \"rgba(9,202,243,.0)\",\r\n                    },\r\n                  ],\r\n                  false\r\n              ),\r\n            },\r\n            markPoint: {\r\n              data: [\r\n                {\r\n                  name: \"最大值\",\r\n                  type: \"max\",\r\n                  valueDim: \"y\",\r\n                  symbol: \"rect\",\r\n                  symbolSize: [60, 26],\r\n                  symbolOffset: [0, -20],\r\n                  itemStyle: {\r\n                    color: \"rgba(0,0,0,0)\",\r\n                  },\r\n                  label: {\r\n                    color: \"#ff276d\",\r\n                    backgroundColor: \"rgba(255,14,14,0.1)\",\r\n\r\n                    borderRadius: 6,\r\n                    borderColor: \"rgba(255,46,46,0.5)\",\r\n                    padding: [7, 14],\r\n                    formatter: \"三级预警：{c}\",\r\n                    borderWidth: 0.5,\r\n                  },\r\n                },\r\n                {\r\n                  name: \"最大值\",\r\n                  type: \"max\",\r\n                  valueDim: \"y\",\r\n                  symbol: \"circle\",\r\n                  symbolSize: 6,\r\n                  itemStyle: {\r\n                    color: \"#ff0000\",\r\n                    shadowColor: \"#ff3434\",\r\n                    shadowBlur: 8,\r\n                  },\r\n                  label: {\r\n                    formatter: \"\",\r\n                  },\r\n                },\r\n              ],\r\n            },\r\n          },\r\n        ],\r\n      };\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang='scss' scoped>\r\n.right_top_inner {\r\n  margin-top: -8px;\r\n}\r\n</style>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/frontend/src/views/indexs/right-top.vue b/frontend/src/views/indexs/right-top.vue
--- a/frontend/src/views/indexs/right-top.vue	(revision fd8204e0a6ebf25a34c136ea9906ae35f40e30b1)
+++ b/frontend/src/views/indexs/right-top.vue	(date 1731312921889)
@@ -19,7 +19,8 @@
 </template>
 
 <script>
-import { currentGET } from "api/modules";
+import axios from 'axios';  // 导入 axios 用于请求后端接口
+import { baseUrl } from "@/api/api";
 import {graphic} from "echarts"
 import {mylog} from "@/utils";
 export default {
@@ -47,88 +48,79 @@
   },
 
   mounted() {
-     this.getData();
+    this.updateData();
   },
   beforeDestroy() {
     this.clearData();
   },
   watch: {
-    province(newVal, oldVal) {
-      if (newVal.indexOf("省") >= 0) {
-
-        this.province = newVal;
-        this.dataItem = {
-          title: ['2021-11', '2021-12', '2022-01', '2022-02', '2022-03','2022-04'],
-          oneLevel: [230, 149, 312, 231, 321, 111],
-          twoLevel: [981, 943, 315, 411, 125, 321],
-          threeLevel: [231, 413, 323, 376, 442, 43]
-        }
-        this.getData();
-      }else {
-        this.dataItem = {
-          title: ['2021-11', '2021-12', '2022-01', '2022-02', '2022-03','2022-04'],
-              oneLevel: [270, 49, 670, 123, 684, 747],
-              twoLevel: [488, 6, 771, 465, 315, 14],
-              threeLevel: [120, 423, 123, 676, 342, 543]
-        }
+    province() {
+      this.updateData();
+    }
+  },
+  methods: {
+    // 根据省份判断调用哪个接口
+    updateData() {
+      if (this.province && this.province !== "中国") {
+        this.getProvinceData();
+      } else {
         this.getData();
       }
-    }
-  },
-  methods: {
-    clearData() {
-      if (this.timer) {
-        clearInterval(this.timer);
-        this.timer = null;
-      }
     },
+// 获取全国数据
     getData() {
       this.pageflag = true;
-      // this.pageflag =false
-      currentGET("big4").then((res) => {
-        if (!this.timer) {
-        }
-        if (res.success) {
-          const data = res.data;
-          mylog(data);
-          data["numList3"] = [120, 423, 123, 676, 342, 543];
-          this.countUserNumData = res.data;
-          this.$nextTick(() => {
-            this.init()
-              // this.switper();
-          });
+      axios.get(`${baseUrl}/city/getHealthLevel`).then((response) => {
+        if (response.code === "200") {
+          this.updateDataItem(response.data);
         } else {
           this.pageflag = false;
           this.$Message({
-            text: res.msg,
+            text: response.msg,
             type: "warning",
           });
         }
+      }).catch((error) => {
+        console.error("Error fetching data:", error);
+        this.pageflag = false;
+      });
+    },
+
+    // 获取省份数据
+    getProvinceData() {
+      this.pageflag = true;
+      axios.get(`${baseUrl}/city/getHealthLevelByCity?cityName=${this.province}`).then((response) => {
+        if (response.code === "200") {
+          this.updateDataItem(response.data);
+        } else {
+          this.pageflag = false;
+          this.$Message({
+            text: response.msg,
+            type: "warning",
+          });
+        }
+      }).catch((error) => {
+        console.error("Error fetching data:", error);
+        this.pageflag = false;
       });
     },
-    //轮询
-    switper() {
+
+    // 更新图表数据项
+    updateDataItem(data) {
+      this.dataItem.title = data.map(item => item.month);
+      this.dataItem.oneLevel = data.map(item => item.L1_count);
+      this.dataItem.twoLevel = data.map(item => item.L2_count);
+      this.dataItem.threeLevel = data.map(item => item.L3_count);
+
+      this.init(); // 调用图表初始化方法
+    },
+    clearData() {
       if (this.timer) {
-        return;
+        clearInterval(this.timer);
+        this.timer = null;
       }
-      let looper = (a) => {
-        this.getData();
-      };
-      this.timer = setInterval(
-        looper,
-        this.$store.state.setting.echartsAutoTime
-      );
-      let myChart = this.$refs.charts.chart;
-      myChart.on("mouseover", (params) => {
-        this.clearData();
-      });
-      myChart.on("mouseout", (params) => {
-        this.timer = setInterval(
-          looper,
-          this.$store.state.setting.echartsAutoTime
-        );
-      });
     },
+
     init() {
       this.option = {
         xAxis: {
Index: frontend/src/views/indexs/center-map.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!--\r\n * @Author: daidai\r\n * @Date: 2022-03-01 11:17:39\r\n * @LastEditors: Please set LastEditors\r\n * @LastEditTime: 2022-09-29 15:50:18\r\n * @FilePath: \\web-pc\\src\\pages\\big-screen\\view\\indexs\\center-map.vue\r\n-->\r\n<template>\r\n  <div class=\"centermap\">\r\n    <div class=\"maptitle\">\r\n      <div class=\"zuo\"></div>\r\n      <span class=\"titletext\">{{ maptitle }}</span>\r\n      <div class=\"you\"></div>\r\n    </div>\r\n    <div class=\"mapwrap\">\r\n      <dv-border-box-13>\r\n        <div class=\"quanguo\" @click=\"toChina()\" v-if=\"code !== 'china'\" >\r\n          中国\r\n        </div>\r\n\r\n        <Echart id=\"CenterMap\" :options=\"options\" ref=\"CenterMap\" width=\"800px\" height=\"590px\" style=\"left: -50px\"/>\r\n      </dv-border-box-13>\r\n    </div>\r\n    <div\r\n        class=\"apartmentDot\"\r\n        v-for=\"val in apartments\"\r\n        :style=\"position(val)\"\r\n        v-on:click=\"toApartment(val)\"\r\n    >\r\n      {{ val.value }}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mylog} from \"@/utils\";\r\nimport xzqCode from \"../../utils/map/xzqCode\";\r\nimport {currentGET} from \"api/modules\";\r\nimport * as echarts from \"echarts\";\r\nimport {GETNOBASE} from \"api\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      maptitle: \"分布图\",\r\n      options: {},\r\n      code: \"china\", //china 代表中国 其他地市是行政编码\r\n      echartBindClick: false,\r\n      isSouthChinaSea: true, //是否要展示南海群岛  修改此值请刷新页面\r\n      name: \"中国\", //判断当前处于哪个地区\r\n      newData: [], // 地图上标的点\r\n      apartments: [],// 小区的点\r\n    };\r\n  },\r\n  computed: {\r\n  },\r\n  created() {\r\n  },\r\n\r\n  mounted() {\r\n    // console.log(xzqCode);\r\n    this.getData(\"china\");\r\n  },\r\n  methods: {\r\n    toChina() {\r\n      this.getData('china');\r\n      this.$emit('childNeedChangeData', \"中国\");\r\n    },\r\n    getData(code) {\r\n      currentGET(\"big8\", {regionCode: code}).then((res) => {\r\n        const data = res.data.dataList;\r\n        if (res.success) {\r\n          this.getGeojson(res.data.regionCode, res.data.dataList);\r\n          this.mapclick();\r\n        } else {\r\n          this.$Message.warning(res.msg);\r\n        }\r\n      });\r\n    },\r\n    /**\r\n     * @description: 获取geojson\r\n     * @param {*} name china 表示中国 其他省份行政区编码\r\n     * @param {*} mydata 接口返回列表数据\r\n     * @return {*}\r\n     */\r\n    async getGeojson(name, mydata) {\r\n      this.code = name;\r\n      //如果要展示南海群岛并且展示的是中国的话\r\n      let geoname = name\r\n      if (this.isSouthChinaSea && name == \"china\") {\r\n        geoname = \"chinaNanhai\";\r\n      }\r\n      //如果有注册地图的话就不用再注册 了\r\n      let mapjson = echarts.getMap(name);\r\n      if (mapjson) {\r\n        mapjson = mapjson.geoJSON;\r\n      } else {\r\n        mapjson = await GETNOBASE(`./map-geojson/${geoname}.json`).then((res) => {\r\n          return res;\r\n        });\r\n        echarts.registerMap(name, mapjson);\r\n      }\r\n      let cityCenter = {};\r\n      let arr = mapjson.features;\r\n      //根据geojson获取省份中心点\r\n      arr.map((item) => {\r\n        cityCenter[item.properties.name] =\r\n            item.properties.centroid || item.properties.center;\r\n      });\r\n\r\n      this.newData = [];\r\n      this.apartments = [];\r\n      // 具体市的点\r\n      if (this.name === \"中国\" || name === 'china') {\r\n        this.newData.push({name: \"徐州市\", value: [117.184811, 34.261792, 1]});\r\n        this.newData.push({name: \"郑州市\", value: [113.477391, 34.626256, 1]});\r\n        this.newData.push({name: \"西安市\", value: [108.797426, 34.10671, 1]});\r\n      } else if (this.name === \"陕西省\") {\r\n        // this.newData.push({name: \"西安市\", value: [108.797426, 34.10671, 1]});\r\n        this.apartments = [\r\n          {\r\n            id: 22,\r\n            value: \"东关南街社区\",\r\n            top: 365,\r\n            left: 200\r\n          },\r\n          {\r\n            id: 23,\r\n            value: \"长安路社区\",\r\n            top: 355,\r\n            left: 430\r\n          },\r\n          {\r\n            id: 24,\r\n            value: \"长乐坊社区\",\r\n            top: 314,\r\n            left: 585\r\n          },\r\n          {\r\n            id: 25,\r\n            value: \"小寨永松路社区\",\r\n            top: 320,\r\n            left: 330\r\n          },\r\n        ]\r\n      } else if (this.name === \"河南省\") {\r\n        // this.newData.push({name: \"郑州市\", value: [113.477391, 34.626256, 1]});\r\n        this.apartments = [\r\n          {\r\n            id: 16,\r\n            value: \"九街示范区\",\r\n            top: 365,\r\n            left: 200\r\n          },\r\n          {\r\n            id: 17,\r\n            value: \"城南示范区\",\r\n            top: 355,\r\n            left: 430\r\n          },\r\n          {\r\n            id: 18,\r\n            value: \"城北示范区\",\r\n            top: 314,\r\n            left: 585\r\n          },\r\n          {\r\n            id: 19,\r\n            value: \"西站示范区\",\r\n            top: 320,\r\n            left: 330\r\n          },\r\n        ]\r\n      } else if (this.name === \"江苏省\") {\r\n        // this.newData.push({name: \"徐州市\", value: [117.184811, 34.261792, 1]});\r\n        this.apartments = [\r\n          {\r\n            id: 13,\r\n            value: \"永安社区\",\r\n            top: 365,\r\n            left: 200\r\n          },\r\n          {\r\n            id: 26,\r\n            value: \"泉山社区\",\r\n            top: 355,\r\n            left: 430\r\n          },\r\n          {\r\n            id: 27,\r\n            value: \"黄山社区\",\r\n            top: 314,\r\n            left: 585\r\n          },\r\n          {\r\n            id: 28,\r\n            value: \"铜沛社区\",\r\n            top: 320,\r\n            left: 330\r\n          },\r\n        ]\r\n      }\r\n\r\n      // 小区的点\r\n\r\n      this.init(name, mydata);\r\n    },\r\n    init(name, data) {\r\n      // console.log(data2);\r\n      let top = 45;\r\n      let zoom = 1.05;\r\n      let option = {\r\n        backgroundColor: \"rgba(0,0,0,0)\",\r\n        tooltip: {\r\n          show: false,\r\n        },\r\n        legend: {\r\n          show: false,\r\n        },\r\n\r\n        geo: {\r\n          map: name,\r\n          roam: false,\r\n          selectedMode: false, //是否允许选中多个区域\r\n          zoom: zoom,\r\n          top: top,\r\n          // aspectScale: 0.78,\r\n          show: false,\r\n        },\r\n        series: [\r\n          {\r\n            name: \"MAP\",\r\n            type: \"map\",\r\n            map: name,\r\n            // aspectScale: 0.78,\r\n            data: data,\r\n            // data: [1,100],\r\n            selectedMode: false, //是否允许选中多个区域\r\n            zoom: zoom,\r\n            geoIndex: 1,\r\n            top: top,\r\n            tooltip: {\r\n              show: true,\r\n              formatter: function (params) {\r\n                if (params.data) {\r\n                  return params.name + \"：\" + params.data[\"value\"];\r\n                } else {\r\n                  return params.name;\r\n                }\r\n              },\r\n              backgroundColor: \"rgba(0,0,0,.6)\",\r\n              borderColor: \"rgba(147, 235, 248, .8)\",\r\n              textStyle: {\r\n                color: \"#FFF\",\r\n              },\r\n            },\r\n            label: {\r\n              show: false,\r\n              color: \"#000\",\r\n              // position: [-10, 0],\r\n              formatter: function (val) {\r\n                // console.log(val)\r\n                if (val.data !== undefined) {\r\n                  return val.name.slice(0, 2);\r\n                } else {\r\n                  return \"\";\r\n                }\r\n              },\r\n              rich: {},\r\n            },\r\n            emphasis: {\r\n              label: {\r\n                show: false,\r\n              },\r\n              itemStyle: {\r\n                areaColor: \"#389BB7\",\r\n                borderWidth: 1,\r\n              },\r\n            },\r\n            itemStyle: {\r\n              borderColor: \"rgba(147, 235, 248, .8)\",\r\n              borderWidth: 1,\r\n              areaColor: {\r\n                type: \"radial\",\r\n                x: 0.5,\r\n                y: 0.5,\r\n                r: 0.8,\r\n                colorStops: [\r\n                  {\r\n                    offset: 0,\r\n                    color: \"rgba(147, 235, 248, 0)\", // 0% 处的颜色\r\n                  },\r\n                  {\r\n                    offset: 1,\r\n                    color: \"rgba(147, 235, 248, .2)\", // 100% 处的颜色\r\n                  },\r\n                ],\r\n                globalCoord: false, // 缺为 false\r\n              },\r\n              shadowColor: \"rgba(128, 217, 248, .3)\",\r\n              shadowOffsetX: -2,\r\n              shadowOffsetY: 2,\r\n              shadowBlur: 10,\r\n            },\r\n          },\r\n          {\r\n            data: this.newData,\r\n            type: \"effectScatter\",\r\n            coordinateSystem: \"geo\",\r\n            symbolSize: function (val) {\r\n              return 4;\r\n              // return val[2] / 50;\r\n            },\r\n            legendHoverLink: true,\r\n            showEffectOn: \"render\",\r\n            rippleEffect: {\r\n              // period: 4,\r\n              scale: 6,\r\n              color: \"rgba(255,255,255, 1)\",\r\n              brushType: \"fill\",\r\n            },\r\n            tooltip: {\r\n              show: true,\r\n              formatter: function (params) {\r\n                if (params.data) {\r\n                  return params.name + \"：\" + params.data[\"value\"][2];\r\n                } else {\r\n                  return params.name;\r\n                }\r\n              },\r\n              backgroundColor: \"rgba(0,0,0,.6)\",\r\n              borderColor: \"rgba(147, 235, 248, .8)\",\r\n              textStyle: {\r\n                color: \"#FFF\",\r\n              },\r\n            },\r\n            label: {\r\n              formatter: (param) => {\r\n                return param.name.slice(0, 2);\r\n              },\r\n              fontSize: 11,\r\n              offset: [0, 2],\r\n              position: \"bottom\",\r\n              textBorderColor: \"#fff\",\r\n              textShadowColor: \"#000\",\r\n              textShadowBlur: 10,\r\n              textBorderWidth: 0,\r\n              color: \"#FFF\",\r\n              show: true,\r\n            },\r\n            // colorBy: \"data\",\r\n            itemStyle: {\r\n              color: \"rgba(255,255,255,1)\",\r\n              borderColor: \"rgba(2255,255,255,2)\",\r\n              borderWidth: 4,\r\n              shadowColor: \"#000\",\r\n              shadowBlur: 10,\r\n            },\r\n          },\r\n        ],\r\n        //动画效果\r\n        // animationDuration: 1000,\r\n        // animationEasing: 'linear',\r\n        // animationDurationUpdate: 1000\r\n      };\r\n      this.options = option;\r\n    },\r\n    message(text) {\r\n      this.$Message({\r\n        text: text,\r\n        type: \"warning\",\r\n      });\r\n    },\r\n    mapclick() {\r\n      if (this.echartBindClick) return;\r\n      //单击切换到级地图，当mapCode有值,说明可以切换到下级地图\r\n      this.$refs.CenterMap.chart.on(\"click\", (params) => {\r\n        let xzqData = xzqCode[params.name];\r\n        this.name = params.name;\r\n        const isProvince = this.name.indexOf(\"省\")\r\n        if (isProvince) {\r\n          console.log(\"开始传递省份\");\r\n          // 传递数据给父组件通知进行数据修改\r\n          this.$emit('childNeedChangeData', this.name);\r\n        }\r\n        switch (xzqData.adcode) {\r\n          case '320000':\r\n            xzqData.adcode = '320300';\r\n            break;\r\n          case '610000':\r\n            xzqData.adcode = '610100';\r\n            break;\r\n          case '410000':\r\n            xzqData.adcode = '410100';\r\n            break;\r\n        }\r\n        if (xzqData) {\r\n          const tempName = params.name;\r\n          this.getData(xzqData.adcode);\r\n        } else {\r\n          // 判断当前具体是哪个地区\r\n          mylog(this.name)\r\n        }\r\n      });\r\n      this.echartBindClick = true;\r\n    },\r\n    // 跳转到具体小区\r\n    toApartment(val) {\r\n      this.$router.push({name:'city',params: {cityName:val.value}})\r\n    },\r\n    /**\r\n     * 小区点位\r\n     * @param val\r\n     * @returns {string}\r\n     */\r\n    position(val) {\r\n      return \"top: \" + val.top + \"px;\" + \"left: \" + val.left + \"px;\";\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.apartmentDot {\r\n  background: #fff;\r\n  width: 20px;\r\n  height: 20px;\r\n  border-radius: 50%;\r\n  z-index: 9999;\r\n  position: absolute;\r\n  //top: 10px;\r\n  //left: 10px;\r\n}\r\n\r\n.centermap {\r\n  margin-bottom: 30px;\r\n  overflow: hidden;\r\n  position: relative;\r\n\r\n  .maptitle {\r\n    height: 60px;\r\n    display: flex;\r\n    justify-content: center;\r\n    padding-top: 10px;\r\n    box-sizing: border-box;\r\n\r\n    .titletext {\r\n      font-size: 28px;\r\n      font-weight: 900;\r\n      letter-spacing: 6px;\r\n      background: linear-gradient(\r\n              92deg,\r\n              #0072ff 0%,\r\n              #00eaff 48.8525390625%,\r\n              #01aaff 100%\r\n      );\r\n      -webkit-background-clip: text;\r\n      -webkit-text-fill-color: transparent;\r\n      margin: 0 10px;\r\n    }\r\n\r\n    .zuo,\r\n    .you {\r\n      background-size: 100% 100%;\r\n      width: 29px;\r\n      height: 20px;\r\n      margin-top: 8px;\r\n    }\r\n\r\n    .zuo {\r\n      background: url(\"../../assets/img/xiezuo.png\") no-repeat;\r\n    }\r\n\r\n    .you {\r\n      background: url(\"../../assets/img/xieyou.png\") no-repeat;\r\n    }\r\n  }\r\n\r\n  .mapwrap {\r\n    height: 548px;\r\n    width: 100%;\r\n    // padding: 0 0 10px 0;\r\n    box-sizing: border-box;\r\n    position: relative;\r\n    display: flex;\r\n    justify-content: space-around;\r\n\r\n    .quanguo {\r\n      position: absolute;\r\n      right: 20px;\r\n      top: -46px;\r\n      width: 80px;\r\n      height: 28px;\r\n      border: 1px solid #00eded;\r\n      border-radius: 10px;\r\n      color: #00f7f6;\r\n      text-align: center;\r\n      line-height: 26px;\r\n      letter-spacing: 6px;\r\n      cursor: pointer;\r\n      box-shadow: 0 2px 4px rgba(0, 237, 237, 0.5),\r\n      0 0 6px rgba(0, 237, 237, 0.4);\r\n    }\r\n  }\r\n}\r\n</style>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/frontend/src/views/indexs/center-map.vue b/frontend/src/views/indexs/center-map.vue
--- a/frontend/src/views/indexs/center-map.vue	(revision fd8204e0a6ebf25a34c136ea9906ae35f40e30b1)
+++ b/frontend/src/views/indexs/center-map.vue	(date 1731315173452)
@@ -58,7 +58,6 @@
   },
 
   mounted() {
-    // console.log(xzqCode);
     this.getData("china");
   },
   methods: {
@@ -115,7 +114,7 @@
         this.newData.push({name: "徐州市", value: [117.184811, 34.261792, 1]});
         this.newData.push({name: "郑州市", value: [113.477391, 34.626256, 1]});
         this.newData.push({name: "西安市", value: [108.797426, 34.10671, 1]});
-      } else if (this.name === "陕西省") {
+      } else if (this.name === "陕西省" || this.name === '西安市') {
         // this.newData.push({name: "西安市", value: [108.797426, 34.10671, 1]});
         this.apartments = [
           {
@@ -143,7 +142,7 @@
             left: 330
           },
         ]
-      } else if (this.name === "河南省") {
+      } else if (this.name === "河南省" || this.name === '郑州市') {
         // this.newData.push({name: "郑州市", value: [113.477391, 34.626256, 1]});
         this.apartments = [
           {
@@ -171,7 +170,7 @@
             left: 330
           },
         ]
-      } else if (this.name === "江苏省") {
+      } else if (this.name === "江苏省" || this.name === '徐州市') {
         // this.newData.push({name: "徐州市", value: [117.184811, 34.261792, 1]});
         this.apartments = [
           {
@@ -200,13 +199,12 @@
           },
         ]
       }
-
       // 小区的点
-
-      this.init(name, mydata);
+      this.$nextTick(() => {
+        this.init(name, mydata);
+      });
     },
     init(name, data) {
-      // console.log(data2);
       let top = 45;
       let zoom = 1.05;
       let option = {
Index: frontend/src/main.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>/*\r\n * @Author: daidai\r\n * @Date: 2022-01-12 14:05:56\r\n * @LastEditors: Please set LastEditors\r\n * @LastEditTime: 2022-09-27 14:55:57\r\n * @FilePath: \\web-pc\\src\\pages\\big-screen\\main.js\r\n */\r\nimport Vue from \"vue\";\r\nimport ElementUI from 'element-ui';\r\nimport 'element-ui/lib/theme-chalk/index.css';\r\nimport App from \"./App.vue\";\r\nimport router from './router'\r\nimport store from './store'\r\nimport {loading,borderBox13,digitalFlop,capsuleChart,borderBox8} from '@jiaminghi/data-view'\r\nimport { Radio,Button,RadioGroup } from 'element-ui'\r\nimport Echart from './components/echart/index.vue'\r\nimport ItemWrap from './components/item-wrap/item-wrap.vue'\r\nimport Message from './components/message/message.vue'\r\nimport Reacquire from './components/reacquire/reacquire.vue'\r\nimport Messages from './components/message/message'\r\nimport \"vue-easytable/libs/theme-default/index.css\";\r\nimport  '@/assets/css/public.scss'\r\nimport \"@/assets/css/index.scss\"\r\n\r\n\r\nimport * as filters from '@/directives/filters'\r\n\r\nrequire('./mock/mock')//是否使用mock\r\nVue.config.productionTip = false;\r\n// 自定义组件\r\nVue.component(\"Echart\",Echart)\r\nVue.component(\"ItemWrap\",ItemWrap)\r\nVue.component(\"Message\",Message)\r\nVue.component(\"Reacquire\",Reacquire)\r\nVue.prototype.$Message =  Messages\r\n// element组件\r\nVue.use(Radio);\r\nVue.use(Button);\r\nVue.use(RadioGroup)\r\nVue.use(ElementUI);\r\n\r\n// datav组件\r\nVue.use(loading)\r\nVue.use(borderBox13)\r\nVue.use(borderBox8)\r\nVue.use(digitalFlop)\r\nVue.use(capsuleChart)\r\n// 全局数据过滤器\r\nObject.keys(filters).forEach(k => Vue.filter(k, filters[k]));\r\nnew Vue({\r\n  router,\r\n  store,\r\n  render: h => h(App)\r\n}).$mount(\"#app\");\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/frontend/src/main.js b/frontend/src/main.js
--- a/frontend/src/main.js	(revision fd8204e0a6ebf25a34c136ea9906ae35f40e30b1)
+++ b/frontend/src/main.js	(date 1731318833345)
@@ -12,7 +12,7 @@
 import router from './router'
 import store from './store'
 import {loading,borderBox13,digitalFlop,capsuleChart,borderBox8} from '@jiaminghi/data-view'
-import { Radio,Button,RadioGroup } from 'element-ui'
+import { Radio,Button,RadioGroup,Menu, Submenu, MenuItem } from 'element-ui'
 import Echart from './components/echart/index.vue'
 import ItemWrap from './components/item-wrap/item-wrap.vue'
 import Message from './components/message/message.vue'
@@ -38,6 +38,11 @@
 Vue.use(Button);
 Vue.use(RadioGroup)
 Vue.use(ElementUI);
+// 单独注册需要的 Element UI 组件
+Vue.component(Menu.name, Menu)
+Vue.component(Submenu.name, Submenu)
+Vue.component(MenuItem.name, MenuItem)
+
 
 // datav组件
 Vue.use(loading)
Index: frontend/src/views/city/One.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><template>\r\n  <div id=\"one\">\r\n    <ul class=\"user_Overview flex\" v-if=\"pageflag\">\r\n      <li class=\"user_Overview-item\" style=\"color: #00fdfa\">\r\n        <div class=\"user_Overview_nums allnum \">\r\n          <dv-digital-flop :config=\"config\" style=\"width:100%;height:100%;\" />\r\n        </div>\r\n        <p>小区人数</p>\r\n      </li>\r\n      <li class=\"user_Overview-item\" style=\"color: #07f7a8\">\r\n        <div class=\"user_Overview_nums online\">\r\n          <dv-digital-flop :config=\"onlineconfig\" style=\"width:100%;height:100%;\" />\r\n        </div>\r\n        <p>总户数</p>\r\n      </li>\r\n<!--      <li class=\"user_Overview-item\" style=\"color: #e3b337\">-->\r\n<!--        <div class=\"user_Overview_nums offline\">-->\r\n<!--          <dv-digital-flop :config=\"offlineconfig\" style=\"width:100%;height:100%;\" />-->\r\n\r\n<!--        </div>-->\r\n<!--        <p>男女比例</p>-->\r\n<!--      </li>-->\r\n      <!--        <li class=\"user_Overview-item\" style=\"color: #f5023d\">-->\r\n      <!--            <div class=\"user_Overview_nums laramnum\">-->\r\n      <!--                <dv-digital-flop :config=\"laramnumconfig\" style=\"width:100%;height:100%;\" />-->\r\n      <!--            </div>-->\r\n      <!--            <p>告警次数</p>-->\r\n      <!--        </li>-->\r\n    </ul>\r\n    <Reacquire v-else @onclick=\"getData\" line-height=\"200px\">\r\n      重新获取\r\n    </Reacquire>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {currentGET} from \"@/api\";\r\nlet style = {\r\n  fontSize: 24\r\n}\r\nexport default {\r\n  name: \"One\",\r\n  data() {\r\n    return {\r\n      options: {},\r\n      userOverview: {\r\n        alarmNum: 0,\r\n        offlineNum: 0,\r\n        onlineNum: 0,\r\n        totalNum: 0,\r\n      },\r\n      pageflag: true,\r\n      timer: null,\r\n      // 男生数\r\n      config: {\r\n        number: [(4579072+6467170+6615501)/10000],\r\n        content: '{nt}',\r\n        style: {\r\n          ...style,\r\n          // stroke: \"#00fdfa\",\r\n          fill: \"#00fdfa\",\r\n        },\r\n      },\r\n      onlineconfig: {\r\n        number: [(4504718+6133404+6337406)/10000],\r\n        content: '{nt}',\r\n        style: {\r\n          ...style,\r\n          // stroke: \"#07f7a8\",\r\n          fill: \"#07f7a8\",\r\n        },\r\n      },\r\n      offlineconfig: {\r\n        number: [1],\r\n        content: '{nt}',\r\n        style: {\r\n          ...style,\r\n          // stroke: \"#e3b337\",\r\n          fill: \"#e3b337\",\r\n        },\r\n      },\r\n      laramnumconfig: {\r\n        number: [0],\r\n        content: '{nt}',\r\n        style: {\r\n          ...style,\r\n          // stroke: \"#f5023d\",\r\n          fill: \"#f5023d\",\r\n        },\r\n      }\r\n\r\n    };\r\n  },\r\n  filters: {\r\n    numsFilter(msg) {\r\n      return msg || 0;\r\n    },\r\n  },\r\n  created() {\r\n    this.getData()\r\n  },\r\n  mounted() {\r\n  },\r\n  beforeDestroy() {\r\n    this.clearData()\r\n\r\n  },\r\n  methods: {\r\n    clearData() {\r\n      if (this.timer) {\r\n        clearInterval(this.timer)\r\n        this.timer = null\r\n      }\r\n    },\r\n    getData() {\r\n      this.pageflag = true;\r\n      currentGET(\"big2\").then((res) => {\r\n        if (!this.timer) {\r\n          console.log(\"设备总览\", res);\r\n        }\r\n        if (res.success) {\r\n          // this.userOverview = res.data;\r\n          // this.onlineconfig = {\r\n          //     ...this.onlineconfig,\r\n          //     number: [res.data.onlineNum]\r\n          // }\r\n          // this.config = {\r\n          //     ...this.config,\r\n          //     number: [res.data.totalNum]\r\n          // }\r\n          // this.offlineconfig = {\r\n          //     ...this.offlineconfig,\r\n          //     number: [res.data.offlineNum]\r\n          // }\r\n          // this.laramnumconfig = {\r\n          //     ...this.laramnumconfig,\r\n          //     number: [res.data.alarmNum]\r\n          // }\r\n          this.switper()\r\n        } else {\r\n          this.pageflag = false;\r\n          this.$Message.warning(res.msg);\r\n        }\r\n      });\r\n    },\r\n    //轮询\r\n    switper() {\r\n      if (this.timer) {\r\n        return\r\n      }\r\n      let looper = (a) => {\r\n        this.getData()\r\n      };\r\n      this.timer = setInterval(looper, this.$store.state.setting.echartsAutoTime);\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.user_Overview {\r\n  position: relative;\r\n  li {\r\n    flex: 1;\r\n\r\n    p {\r\n      text-align: center;\r\n      height: 16px;\r\n      font-size: 16px;\r\n    }\r\n\r\n    .user_Overview_nums {\r\n      width: 100px;\r\n      height: 100px;\r\n      text-align: center;\r\n      line-height: 100px;\r\n      font-size: 22px;\r\n      margin: 50px auto 30px;\r\n      background-size: cover;\r\n      background-position: center center;\r\n      position: relative;\r\n\r\n      &::before {\r\n        content: '';\r\n        position: absolute;\r\n        width: 100%;\r\n        height: 100%;\r\n        top: 0;\r\n        left: 0;\r\n      }\r\n\r\n      &.bgdonghua::before {\r\n        animation: rotating 14s linear infinite;\r\n      }\r\n    }\r\n\r\n    .allnum {\r\n\r\n      // background-image: url(\"../../assets/img/left_top_lan.png\");\r\n      &::before {\r\n        background-image: url(\"../../assets/img/left_top_lan.png\");\r\n\r\n      }\r\n    }\r\n\r\n    .online {\r\n      &::before {\r\n        background-image: url(\"../../assets/img/left_top_lv.png\");\r\n\r\n      }\r\n    }\r\n\r\n    .offline {\r\n      &::before {\r\n        background-image: url(\"../../assets/img/left_top_huang.png\");\r\n\r\n      }\r\n    }\r\n\r\n    .laramnum {\r\n      &::before {\r\n        background-image: url(\"../../assets/img/left_top_hong.png\");\r\n\r\n      }\r\n    }\r\n  }\r\n}\r\n.user_Overview li {\r\n  margin-top: 50px;\r\n}\r\n</style>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/frontend/src/views/city/One.vue b/frontend/src/views/city/One.vue
--- a/frontend/src/views/city/One.vue	(revision fd8204e0a6ebf25a34c136ea9906ae35f40e30b1)
+++ b/frontend/src/views/city/One.vue	(date 1731315947427)
@@ -13,19 +13,7 @@
         </div>
         <p>总户数</p>
       </li>
-<!--      <li class="user_Overview-item" style="color: #e3b337">-->
-<!--        <div class="user_Overview_nums offline">-->
-<!--          <dv-digital-flop :config="offlineconfig" style="width:100%;height:100%;" />-->
 
-<!--        </div>-->
-<!--        <p>男女比例</p>-->
-<!--      </li>-->
-      <!--        <li class="user_Overview-item" style="color: #f5023d">-->
-      <!--            <div class="user_Overview_nums laramnum">-->
-      <!--                <dv-digital-flop :config="laramnumconfig" style="width:100%;height:100%;" />-->
-      <!--            </div>-->
-      <!--            <p>告警次数</p>-->
-      <!--        </li>-->
     </ul>
     <Reacquire v-else @onclick="getData" line-height="200px">
       重新获取
Index: frontend/src/views/model/index.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!--\r\n * @Author: Author T4mako\r\n * @Date: 2024-11-05 13:23:59\r\n-->\r\n<template>\r\n  <ScaleScreen \r\n  :width=\"1920\"\r\n  :height=\"1080\"\r\n  class=\"scale-wrap\"\r\n  :selfAdaption=\"$store.state.setting.isScale\">\r\n    <div class=\"bg\">\r\n      <dv-loading v-if=\"loading\">Loading...</dv-loading>\r\n      <div v-else class=\"host-body\">\r\n        <!-- 头部 s -->\r\n        <div class=\"d-flex jc-center title_wrap\" style=\"z-index: 999\">\r\n          <div class=\"zuojuxing\"></div>\r\n          <div class=\"youjuxing\"></div>\r\n          <div class=\"guang\"></div>\r\n          <div class=\"d-flex jc-center\">\r\n            <div class=\"title\">\r\n              <span class=\"title-text\"v-on:click=\"()=>{this.$router.push({path:'/'})}\">数字健康家庭服务城市平台</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"timers\">\r\n            {{ dateYear }} {{ dateWeek }} {{ dateDay }}\r\n            <i\r\n              class=\"blq-icon-shezhi02\"\r\n              style=\"margin-left: 10px\"\r\n              @click=\"showSetting\"\r\n            ></i>\r\n          </div>\r\n        </div>\r\n        <router-view></router-view>\r\n      </div>\r\n  </div>\r\n  </ScaleScreen>\r\n  \r\n</template>\r\n\r\n<script>\r\nimport ScaleScreen from \"@/components/scale-screen/scale-screen.vue\";\r\nexport default {\r\n  components: { ScaleScreen },\r\n  data(){\r\n    return{\r\n      timing: null,\r\n      loading: false,\r\n      dateDay: null,\r\n      dateYear: null,\r\n      dateWeek: null,\r\n      weekday: [\"周日\", \"周一\", \"周二\", \"周三\", \"周四\", \"周五\", \"周六\"],\r\n      input: '',\r\n      path: '',\r\n    }\r\n  },filters: {\r\n    numsFilter(msg) {\r\n      return msg || 0;\r\n    },\r\n  },\r\n  computed: {},\r\n  created() {\r\n    this.path = this.$route.path\r\n    console.log(this.$route.path);\r\n  },\r\n  mounted() {\r\n    this.timeFn();\r\n    this.cancelLoading();\r\n  },\r\n  beforeDestroy() {\r\n    clearInterval(this.timing);\r\n  },\r\n  methods: {\r\n    showSetting() {\r\n      this.$refs.setting.init();\r\n    },\r\n    timeFn() {\r\n      this.timing = setInterval(() => {\r\n        this.dateDay = formatTime(new Date(), \"HH: mm: ss\");\r\n        this.dateYear = formatTime(new Date(), \"yyyy-MM-dd\");\r\n        this.dateWeek = this.weekday[new Date().getDay()];\r\n      }, 1000);\r\n    },\r\n    cancelLoading() {\r\n      let timer = setTimeout(() => {\r\n        this.loading = false;\r\n        clearTimeout(timer);\r\n      }, 500);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.bg {\r\n        width: 100%;\r\n        height: 100%;\r\n        padding: 16px 16px 10px 16px;\r\n        box-sizing: border-box;\r\n        background-size: cover;\r\n        background-position: center center;\r\n    }\r\n@import \"model.scss\";\r\n\r\n</style>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/frontend/src/views/model/index.vue b/frontend/src/views/model/index.vue
--- a/frontend/src/views/model/index.vue	(revision fd8204e0a6ebf25a34c136ea9906ae35f40e30b1)
+++ b/frontend/src/views/model/index.vue	(date 1731327205223)
@@ -99,6 +99,6 @@
         background-size: cover;
         background-position: center center;
     }
-@import "model.scss";
+@import "../environment/env";
 
 </style>
Index: frontend/src/views/HomeIndex.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><template>\r\n  <div class=\"platform-container\">\r\n    <!-- 背景图片容器 -->\r\n    <div class=\"background\">\r\n      <!-- 标题 -->\r\n      <h1 class=\"title-text\">数字健康家庭服务城市平台</h1>\r\n\r\n      <!-- 图片展示区 -->\r\n      <div class=\"images-row\">\r\n        <div class=\"image-container\" v-for=\"(image, index) in images\" :key=\"index\" @click=\"goTo(image.path)\">\r\n          <img :src=\"image.src\" :alt=\"image.alt\" class=\"image-item\" />\r\n          <p class=\"image-caption\">{{ image.caption }}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"HomeIndex\",\r\n  data() {\r\n    return {\r\n      images: [\r\n        { src: require('@/assets/img/back1.png'), alt: \"City Health - Person\", caption: \"城市家庭人员健康\", path: \"/index\" },\r\n        { src: require('@/assets/img/back2.png'), alt: \"City Health - Building\", caption: \"城市健康建筑环境\" },\r\n        { src: require('@/assets/img/back3.png'), alt: \"Active Health - City Map\", caption: \"主动健康城市图谱\" },\r\n        { src: require('@/assets/img/back4.png'), alt: \"Active Health - Model\", caption: \"主动健康模型\",path:\"/model\" },\r\n      ]\r\n    };\r\n  },\r\n  methods: {\r\n    goTo(path) {\r\n      this.$router.push(path);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.platform-container {\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n}\r\n\r\n.background {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-image: url('~@/assets/img/home-background.png');\r\n  background-size: cover;\r\n  background-position: center;\r\n  background-repeat: no-repeat;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.title {\r\n  color: white;\r\n  font-size: 2.5rem;\r\n  text-align: center;\r\n  margin-top: 1rem;\r\n}\r\n\r\n.images-row {\r\n  display: flex;\r\n  justify-content: space-around; /* 修改为 space-around，使图片均匀分布在容器内 */\r\n  width: 80%; /* 设置宽度，确保图片容器左右留出足够空间 */\r\n  margin-top: 10rem;\r\n}\r\n\r\n.image-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  margin: 0 1rem;\r\n}\r\n\r\n.image-item {\r\n  width: 250px;\r\n  height: 250px;\r\n  object-fit: cover;\r\n  margin-bottom: 0.5rem;\r\n  cursor: pointer;\r\n  border-radius: 10px;\r\n}\r\n\r\n.image-caption {\r\n  margin-top: 5px;\r\n  color: white;\r\n  font-size: 1.25rem;\r\n  text-align: center;\r\n  width: 100%; /* 使文字在图片下方居中 */\r\n  background: linear-gradient(92deg, #0072FF 0%, #00EAFF 48.8525390625%, #01AAFF 100%);\r\n  -webkit-background-clip: text;\r\n  -webkit-text-fill-color: transparent;\r\n}\r\n.title-text {\r\n  font-size: 38px;\r\n  font-weight: 900;\r\n  background: linear-gradient(92deg, #0072FF 0%, #00EAFF 48.8525390625%, #01AAFF 100%);\r\n  -webkit-background-clip: text;\r\n  -webkit-text-fill-color: transparent;\r\n}\r\n</style>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/frontend/src/views/HomeIndex.vue b/frontend/src/views/HomeIndex.vue
--- a/frontend/src/views/HomeIndex.vue	(revision fd8204e0a6ebf25a34c136ea9906ae35f40e30b1)
+++ b/frontend/src/views/HomeIndex.vue	(date 1731316208399)
@@ -23,7 +23,7 @@
     return {
       images: [
         { src: require('@/assets/img/back1.png'), alt: "City Health - Person", caption: "城市家庭人员健康", path: "/index" },
-        { src: require('@/assets/img/back2.png'), alt: "City Health - Building", caption: "城市健康建筑环境" },
+        { src: require('@/assets/img/back2.png'), alt: "City Health - Building", caption: "城市健康建筑环境",path: "/environment" },
         { src: require('@/assets/img/back3.png'), alt: "Active Health - City Map", caption: "主动健康城市图谱" },
         { src: require('@/assets/img/back4.png'), alt: "Active Health - Model", caption: "主动健康模型",path:"/model" },
       ]
Index: frontend/src/views/indexs/right-center.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!--\r\n * @Author: daidai\r\n * @Date: 2022-03-01 15:51:43\r\n * @LastEditors: Please set LastEditors\r\n * @LastEditTime: 2022-09-29 15:12:46\r\n * @FilePath: \\web-pc\\src\\pages\\big-screen\\view\\indexs\\right-bottom.vue\r\n-->\r\n<template>\r\n  <div class=\"right_ottom\" ref=\"rightBottom\">\r\n<!--    <dv-capsule-chart :config=\"config\" style=\"width:100%;height:260px\" />-->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { currentGET } from 'api/modules'\r\nimport {mylog} from \"@/utils\";\r\nimport * as echarts from 'echarts';\r\nexport default {\r\n  props: {\r\n    province: {\r\n      type: String,\r\n      default: '',\r\n    }\r\n  },\r\n  name: \"rightCenter\",\r\n  data() {\r\n    return {\r\n      gatewayno: '',\r\n      config: {\r\n        showValue: true,\r\n        unit: \"人\",\r\n        data: []\r\n      },\r\n      dataItem: [\r\n        { value: 1048, name: '30岁以下' },\r\n        { value: 735, name: '30~40岁' },\r\n        { value: 580, name: '40~50岁' },\r\n        { value: 484, name: '50~60岁' },\r\n        { value: 300, name: '60~70岁' },\r\n        { value: 300, name: '70岁以上' }\r\n      ]\r\n    };\r\n  },\r\n  computed: {\r\n  },\r\n  mounted() {\r\n    this.getData();\r\n  },\r\n  watch: {\r\n    province(newVal, oldVal) {\r\n      this.province = newVal;\r\n      if (newVal.indexOf(\"省\") >= 0) {\r\n\r\n        this.dataItem = [\r\n          { value: 234, name: '30岁以下' },\r\n          { value: 111, name: '30~40岁' },\r\n          { value: 342, name: '40~50岁' },\r\n          { value: 212, name: '50~60岁' },\r\n          { value: 321, name: '60~70岁' },\r\n          { value: 654, name: '70岁以上' }\r\n        ]\r\n        this.getData();\r\n      }else {\r\n        this.dataItem = [\r\n          { value: 1048, name: '30岁以下' },\r\n          { value: 735, name: '30~40岁' },\r\n          { value: 580, name: '40~50岁' },\r\n          { value: 484, name: '50~60岁' },\r\n          { value: 300, name: '60~70岁' },\r\n          { value: 300, name: '70岁以上' }\r\n        ]\r\n        this.getData();\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    getData() {\r\n      let app = {};\r\n\r\n      let chartDom = this.$refs.rightBottom;\r\n      let myChart = echarts.init(chartDom);\r\n      let option;\r\n\r\n      option = {\r\n\r\n        tooltip: {\r\n          trigger: 'item',\r\n        },\r\n        legend: {\r\n          orient: 'vertical',\r\n          left: 'left',\r\n          textStyle: {\r\n            fontSize: 12,\r\n            color: \"white\"\r\n          }\r\n        },\r\n\r\n        series: [\r\n          {\r\n            name: '年龄',\r\n            type: 'pie',\r\n            radius: '50%',\r\n            data: this.dataItem,\r\n            label: {\r\n              color: 'white',\r\n              fontSize: 14\r\n            },\r\n            emphasis: {\r\n              itemStyle: {\r\n                shadowBlur: 10,\r\n                shadowOffsetX: 0,\r\n                shadowColor: 'rgba(255,255,255,0.5)',\r\n              }\r\n            },\r\n          }\r\n        ]\r\n      };\r\n\r\n      option && myChart.setOption(option);\r\n\r\n    }\r\n  },\r\n};\r\n</script>\r\n<style lang='scss' scoped>\r\n.right_ottom {\r\n  height: 500px;\r\n}\r\n\r\n</style>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/frontend/src/views/indexs/right-center.vue b/frontend/src/views/indexs/right-center.vue
--- a/frontend/src/views/indexs/right-center.vue	(revision fd8204e0a6ebf25a34c136ea9906ae35f40e30b1)
+++ b/frontend/src/views/indexs/right-center.vue	(date 1730948627210)
@@ -1,19 +1,13 @@
-<!--
- * @Author: daidai
- * @Date: 2022-03-01 15:51:43
- * @LastEditors: Please set LastEditors
- * @LastEditTime: 2022-09-29 15:12:46
- * @FilePath: \web-pc\src\pages\big-screen\view\indexs\right-bottom.vue
--->
+
 <template>
   <div class="right_ottom" ref="rightBottom">
-<!--    <dv-capsule-chart :config="config" style="width:100%;height:260px" />-->
+
   </div>
 </template>
 
 <script>
-import { currentGET } from 'api/modules'
-import {mylog} from "@/utils";
+import axios from 'axios';  // 导入 axios 用于请求后端接口
+import { baseUrl } from "@/api/api";
 import * as echarts from 'echarts';
 export default {
   props: {
@@ -31,49 +25,91 @@
         unit: "人",
         data: []
       },
-      dataItem: [
-        { value: 1048, name: '30岁以下' },
-        { value: 735, name: '30~40岁' },
-        { value: 580, name: '40~50岁' },
-        { value: 484, name: '50~60岁' },
-        { value: 300, name: '60~70岁' },
-        { value: 300, name: '70岁以上' }
-      ]
+      dataItem: []
     };
   },
   computed: {
   },
   mounted() {
-    this.getData();
+    this.fetchData();  // 初次加载时根据 province 获取数据
   },
   watch: {
-    province(newVal, oldVal) {
-      this.province = newVal;
-      if (newVal.indexOf("省") >= 0) {
-
-        this.dataItem = [
-          { value: 234, name: '30岁以下' },
-          { value: 111, name: '30~40岁' },
-          { value: 342, name: '40~50岁' },
-          { value: 212, name: '50~60岁' },
-          { value: 321, name: '60~70岁' },
-          { value: 654, name: '70岁以上' }
-        ]
-        this.getData();
-      }else {
-        this.dataItem = [
-          { value: 1048, name: '30岁以下' },
-          { value: 735, name: '30~40岁' },
-          { value: 580, name: '40~50岁' },
-          { value: 484, name: '50~60岁' },
-          { value: 300, name: '60~70岁' },
-          { value: 300, name: '70岁以上' }
-        ]
-        this.getData();
-      }
-    }
-  },
-  methods: {
+    // 监听 province 属性的变化并根据新值获取相应的数据
+    province(newVal) {
+      this.fetchData();
+    }
+  },
+  methods: {
+    fetchData() {
+      if (!this.province || this.province === "中国") {
+        this.fetchNationalData();
+      } else {
+        this.fetchProvinceData(this.province);
+      }
+    },
+    // 获取全国数据并更新 dataItem
+    fetchNationalData() {
+      axios.get(`${baseUrl}/city/getHealthStatus`)
+          .then(response => {
+            if (response.code === "200") {
+              const data = response.data;
+              this.updateDataItem(data);  // 更新 dataItem
+            } else {
+              console.warn("Failed to fetch national data:", response.msg);
+            }
+          })
+          .catch(error => {
+            console.error("Error fetching national data:", error);
+          });
+    },
+
+    // 获取指定省份的数据并更新 dataItem
+    fetchProvinceData(provinceName) {
+      axios.get(`${baseUrl}/city/getHealthStatusByCity`, {
+        params: { cityName: provinceName }
+      })
+          .then(response => {
+            if (response.code === "200") {
+              const data = response.data;  // 数据已是数组格式
+              this.updateDataItem(data);  // 更新 dataItem
+            } else {
+              console.warn("Failed to fetch province data:", response.msg);
+            }
+          })
+          .catch(error => {
+            console.error("Error fetching province data:", error);
+          });
+    },
+
+    // 更新 dataItem 的数据
+    updateDataItem(data) {
+      const ageGroups = {
+        '30岁以下': 0,
+        '30~40岁': 0,
+        '40~50岁': 0,
+        '50~60岁': 0,
+        '60~70岁': 0,
+        '70岁以上': 0,
+      };
+
+      data.forEach(item => {
+        ageGroups['30岁以下'] += item.age_30 || 0;
+        ageGroups['30~40岁'] += item.age_30_40 || 0;
+        ageGroups['40~50岁'] += item.age_40_50 || 0;
+        ageGroups['50~60岁'] += item.age_50_60 || 0;
+        ageGroups['60~70岁'] += item.age_60_70 || 0;
+        ageGroups['70岁以上'] += item.age_70 || 0;
+      });
+
+      // 将数据格式更新为饼图所需的格式
+      this.dataItem = Object.keys(ageGroups).map(key => ({
+        value: ageGroups[key],
+        name: key
+      }));
+
+      // 调用 getData 方法进行渲染
+      this.getData();
+    },
     getData() {
       let app = {};
 
Index: frontend/src/views/environment/Index.vue
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/frontend/src/views/environment/Index.vue b/frontend/src/views/environment/Index.vue
new file mode 100644
--- /dev/null	(date 1731327649799)
+++ b/frontend/src/views/environment/Index.vue	(date 1731327649799)
@@ -0,0 +1,98 @@
+<!--
+ * @Author: Author T4mako
+ * @Date: 2024-11-05 13:23:59
+-->
+<template>
+  <ScaleScreen
+      :width="1920"
+      :height="1080"
+      class="scale-wrap"
+      :selfAdaption="$store.state.setting.isScale">
+    <div class="bg">
+      <dv-loading v-if="loading">Loading...</dv-loading>
+      <div v-else class="host-body">
+        <!-- 头部 s -->
+        <div class="d-flex jc-center title_wrap" style="z-index: 999">
+          <div class="zuojuxing"></div>
+          <div class="youjuxing"></div>
+          <div class="guang"></div>
+          <div class="d-flex jc-center">
+            <div class="title">
+              <span class="title-text"v-on:click="()=>{this.$router.push({path:'/'})}">数字健康家庭服务城市平台</span>
+            </div>
+          </div>
+          <div class="timers">
+            {{ dateYear }} {{ dateWeek }} {{ dateDay }}
+          </div>
+        </div>
+        <router-view></router-view>
+      </div>
+    </div>
+
+  </ScaleScreen>
+
+</template>
+
+<script>
+import ScaleScreen from "@/components/scale-screen/scale-screen.vue";
+import { formatTime } from "@/utils/index.js";
+export default {
+  components: { ScaleScreen },
+  data(){
+    return{
+      timing: null,
+      loading: false,
+      dateDay: null,
+      dateYear: null,
+      dateWeek: null,
+      weekday: ["周日", "周一", "周二", "周三", "周四", "周五", "周六"],
+      input: '',
+      path: '',
+    }
+  },filters: {
+    numsFilter(msg) {
+      return msg || 0;
+    },
+  },
+  computed: {},
+  created() {
+    this.path = this.$route.path
+
+  },
+  mounted() {
+    this.timeFn();
+    this.cancelLoading();
+  },
+  beforeDestroy() {
+    clearInterval(this.timing);
+  },
+  methods: {
+    timeFn() {
+      this.timing = setInterval(() => {
+        this.dateDay = formatTime(new Date(), "HH: mm: ss");
+        this.dateYear = formatTime(new Date(), "yyyy-MM-dd");
+        this.dateWeek = this.weekday[new Date().getDay()];
+      }, 1000);
+    },
+    cancelLoading() {
+      let timer = setTimeout(() => {
+        this.loading = false;
+        clearTimeout(timer);
+      }, 500);
+    },
+  },
+};
+</script>
+
+<style lang="scss" scoped>
+.bg {
+  width: 100%;
+  height: 100%;
+  padding: 16px 16px 10px 16px;
+  box-sizing: border-box;
+  background-size: cover;
+  background-position: center center;
+}
+@import "env";
+
+</style>
diff --git a/frontend/src/views/model/model.scss b/frontend/src/views/environment/env.scss
rename from frontend/src/views/model/model.scss
rename to frontend/src/views/environment/env.scss
